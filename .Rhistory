?NSD::`NSD-package`
?list
library(NSD)
data("ISdata")
data("RSdata")
data("months.balaton")
class(ISdata)
class(RSdata)
class(months.balaton)
class(ISdata);dim(ISdata)
class(RSdata);dim(RSdata)
class(months.balaton);length(months.balaton)
data("ISdata")
data("RSdata")
data("coords.IS")
data("coords.RS")
data("months.balaton")
class(ISdata);dim(ISdata)
class(RSdata);dim(RSdata)
class(coords.IS);dim(coords.IS)
class(coords.RS);dim(coords.RS)
class(months.balaton);length(months.balaton)
which.closest <- numeric(nrow(coords.IS))
for(i in 1:nrow(coords.IS)){
which.closest[i] <- which.min(sp::spDistsN1(coords.RS,coords.IS[i,]))
}
library(NSD)
which.closest
library(NSD)
data("ISdata")
data("RSdata")
data("coords.IS")
data("coords.RS")
data("months.balaton")
class(ISdata); dim(ISdata)
class(RSdata); dim(RSdata)
class(coords.IS); dim(coords.IS)
class(coords.RS); dim(coords.RS)
class(months.balaton); length(months.balaton)
which.closest <- numeric(nrow(coords.IS))
for(i in 1:nrow(coords.IS)){
which.closest[i] <- which.min(sp::spDistsN1(coords.RS,coords.IS[i,]))
}
which.closest
data("which.closest")
which.closest
data("which.closest.RS")
dim(which.closest.RS)
length(which.closest.RS)
plot(coords.RS,pch=15,cex=0.1,col="grey")
points(coords.IS,pch=16,col="dodgerblue")
points(coords.RS[which.closest,],pch=4,col="red")
legend("topleft", legend = c("Satellite grid cell centres", "In situ point locations", "Closest grid cells to point locations"), pch = c(15, 16, 4), pt.cex = c(0.1, 1, 1), col = c("grey", "dodgerblue", "red"), bty = "n")
plot(coords.RS, pch = 15, cex = 0.1, col = "grey", xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)", bty="n")
points(coords.IS, pch = 16, col = "dodgerblue")
points(coords.RS[which.closest, ], pch = 4, col = "red")
legend("topleft", legend = c("Satellite grid cell centres", "In situ point locations", "Closest grid cells to point locations"), pch = c(15, 16, 4), pt.cex = c(0.1, 1, 1), col = c("grey", "dodgerblue", "red"), bty = "n")
legend("topleft", legend = c("Satellite grid cell centres", "In situ point locations", "Closest grid cells to point locations"), pch = c(15, 16, 4), pt.cex = c(0.1, 1, 1), col = c("grey", "dodgerblue", "red"), bty = "n")
legend("topleft", legend = c("Satellite grid cell centres", "In situ point locations", "Closest grid cells to point locations"), pch = c(15, 16, 4), pt.cex = c(0.2, 1, 1), col = c("grey", "dodgerblue", "red"), bty = "n")
legend("topleft", legend = c("Satellite grid cell centres", "In situ point locations", "Closest grid cells to point locations"), pch = c(15, 16, 4), pt.cex = c(0.5, 1, 1), col = c("grey", "dodgerblue", "red"), bty = "n")
legend("topleft", legend = c("Satellite grid cell centres", "In situ point locations", "Closest grid cells to point locations"), pch = c(15, 16, 4), pt.cex = c(0.25, 1, 1), col = c("grey", "dodgerblue", "red"), bty = "n")
plot(coords.RS, pch = 15, cex = 0.1, col = "grey", xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)", bty="n")
points(coords.IS, pch = 16, col = "dodgerblue")
points(coords.RS[which.closest, ], pch = 4, col = "red")
legend("topleft", legend = c("Satellite grid cell centres", "In situ point locations", "Closest grid cells to point locations"), pch = c(15, 16, 4), pt.cex = c(0.25, 1, 1), col = c("grey", "dodgerblue", "red"), bty = "n")
plot(coords.RS, pch = 15, cex = 0.25, col = "grey", xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)", bty="n")
points(coords.IS, pch = 16, col = "dodgerblue")
points(coords.RS[which.closest, ], pch = 4, col = "red")
legend("topleft", legend = c("Satellite grid cell centres", "In situ point locations", "Closest grid cells to point locations"), pch = c(15, 16, 4), pt.cex = c(0.25, 1, 1), col = c("grey", "dodgerblue", "red"), bty = "n")
plot(ISdata[,1])
plot(ISdata[,1]~months.balaton)
plot(ISdata[,1]~months.balaton,type="l")
plot(ISdata[,2]~months.balaton,type="l")
plot(ISdata[,5]~months.balaton,type="l")
plot(ISdata[,6]~months.balaton,type="l")
plot(ISdata[,7]~months.balaton,type="l")
plot(ISdata[,8]~months.balaton,type="l")
plot(ISdata[,9]~months.balaton,type="l")
plot(ISdata[, 6] ~ months.balaton, type = "o", pch = 16)
plot(ISdata[, 6] ~ months.balaton, type = "o", pch = 16, col = "grey", xlab = "Year", ylab = "Data value")
points(RSdata[, which.closest[6]] ~ months.balaton, type = "o", pch = 15, col= "red", lty = 2)
plot(ISdata[, 6] ~ months.balaton, type = "o", pch = 16, col = "grey", xlab = "Year", ylab = "Data value",
ylim = c(min(c(ISdata[, 6], RSdata[, which.closest[6]])), max(c(ISdata[, 6], RSdata[, which.closest[6]]))))
points(RSdata[, which.closest[6]] ~ months.balaton, type = "o", pch = 15, col= "red", lty = 2)
plot(ISdata[, 6] ~ months.balaton, type = "o", pch = 16, col = "grey", xlab = "Year", ylab = "Data value",
ylim = c(min(c(ISdata[, 6], RSdata[, which.closest[6]]), na.rm = TRUE), max(c(ISdata[, 6], RSdata[, which.closest[6]]), na.rm = TRUE)))
points(RSdata[, which.closest[6]] ~ months.balaton, type = "o", pch = 15, col= "red", lty = 2)
plot(ISdata[, 6] ~ months.balaton, type = "o", pch = 16, col = "black", xlab = "Year", ylab = "Data value",
ylim = c(min(c(ISdata[, 6], RSdata[, which.closest[6]]), na.rm = TRUE), max(c(ISdata[, 6], RSdata[, which.closest[6]]), na.rm = TRUE)))
points(RSdata[, which.closest[6]] ~ months.balaton, type = "o", pch = 15, col= "red", lty = 2)
plot(ISdata[, 6] ~ months.balaton, type = "o", pch = 16, col = "black", xlab = "Year", ylab = "Data value",
ylim = c(min(c(ISdata[, 6], RSdata[, which.closest[6]]), na.rm = TRUE), max(c(ISdata[, 6], RSdata[, which.closest[6]]), na.rm = TRUE)))
points(RSdata[, which.closest[6]] ~ months.balaton, type = "o", pch = 15, col= "grey", lty = 2)
points(RSdata[, which.closest[6]] ~ months.balaton, type = "o", pch = 15, col= "dodgerblue", lty = 2)
points(RSdata[, which.closest[6]] ~ months.balaton, type = "o", pch = 15, col= "deepskyblue", lty = 2)
plot(ISdata[, 6] ~ months.balaton, type = "o", pch = 16, col = "black", xlab = "Year", ylab = "Data value",
ylim = c(min(c(ISdata[, 6], RSdata[, which.closest[6]]), na.rm = TRUE), max(c(ISdata[, 6], RSdata[, which.closest[6]]), na.rm = TRUE)), bty = "n")
points(RSdata[, which.closest[6]] ~ months.balaton, type = "o", pch = 15, col= "deepskyblue", lty = 2)
legend("topright", legend = c("In situ data", "Satellite data"), pch = c(16, 15), col = c("black", "deepskyblue"), horiz = TRUE, bty = "n")
plot(ISdata[, 6] ~ months.balaton, type = "o", pch = 16, col = "black", xlab = "Year", ylab = "Data value",
ylim = c(min(c(ISdata[, 6], RSdata[, which.closest[6]]), na.rm = TRUE), max(c(ISdata[, 6], RSdata[, which.closest[6]]), na.rm = TRUE)), bty = "n")
points(RSdata[, which.closest[6]] ~ months.balaton, type = "o", pch = 15, col= "deepskyblue", lty = 2)
legend("topright", legend = c("In situ data", "Satellite data"), pch = c(16, 15), lty = c(1, 2), col = c("black", "deepskyblue"), horiz = TRUE, bty = "n")
RSdata[1, ]
RSdata[1, ]
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[1, ], ISdata[1, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE)
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 15, cex=0.1)
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 15, cex=0.5)
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 15, cex=0.5, col.regions = rev(heat.colors(100)))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[2, ], ISdata[2, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 15, cex=0.5, col.regions = rev(heat.colors(100)))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[3, ], ISdata[3, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 15, cex=0.5, col.regions = rev(heat.colors(100)))
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 15, cex=c(rep(0.5, 7616), rep( 2, 9)), col.regions = rev(heat.colors(100)))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[4, ], ISdata[4, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 15, cex=c(rep(0.5, 7616), rep( 2, 9)), col.regions = rev(heat.colors(100)))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[5, ], ISdata[5, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = c(rep(15, 7616), rep(16, 9)), cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[5, ], ISdata[5, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = c(rep(15, 7616), rep(16, 9)), cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=16))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[5, ], ISdata[5, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = c(rep(15, 7616), rep(16, 9)), cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[6, ], ISdata[6, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = c(rep(15, 7616), rep(16, 9)), cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[6, ], ISdata[6, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = c(rep(15, 7616), rep(16, 9)), cex=c(rep(0.5, 7616), rep(2, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1))
months.balaton
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[50, ], ISdata[50, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = c(rep(15, 7616), rep(16, 9)), cex=c(rep(0.5, 7616), rep(2, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[50, ], ISdata[50, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(2, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[50, ], ISdata[50, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[50, ], ISdata[50, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1.25))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[60, ], ISdata[60, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1.25))
ISdata
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[74, ], ISdata[74, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1.25))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[77, ], ISdata[77, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1.25))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[95, ], ISdata[95, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1.25))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[96, ], ISdata[96, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1.25))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[98, ], ISdata[98, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1.25))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[99, ], ISdata[99, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1.25))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[100, ], ISdata[100, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1.25))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[101, ], ISdata[101, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1.25))
data.spatial.month1 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[102, ], ISdata[102, ]))
sp::coordinates(data.spatial.month1) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month1, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(heat.colors(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1.25))
data.spatial.month102 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[102, ], ISdata[102, ]))
sp::coordinates(data.spatial.month102) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month102, colorkey= TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(viridis::viridis(100)), sp.layout = list("sp.points", locations.insitu, pch=1, col="white", cex = 1.25))
data.spatial.month102 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[102, ], ISdata[102, ]))
sp::coordinates(data.spatial.month102) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month102, colorkey = TRUE, pch = 16, cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(viridis::viridis(100)), sp.layout = list("sp.points", locations.insitu, pch = 1, col = "white", cex = 1.25), scales = list(draw = TRUE), xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)")
library(NSD)
data(ISdata)
data(RSdata)
data(coords.IS)
data(coords.RS)
data(coords.outline)
data(which.closest)
data(which.closest.RS)
data(months.balaton)
model3 <- run.NSDmodel(nIter = 1000, yData = ISdata, xData = RSdata[, which.closest],
xPred = RSdata[, which.closest.RS], coordsData = coords.IS,
coordsPred = coords.RS[which.closest.RS, ], times.yData = months.balaton,
times.xData = months.balaton, times.xPred = months.balaton,
times.yPred = months.balaton, basis.type = "fourier", basis.dim = 9)
summary.model3 <- summary_NSD(model3)
dim(summary.model3$pred.mat)
pred.spatial.month102 <- cbind.data.frame(lon = c(coords.RS[, which.closest.RS[1]], coords.IS[, 1]),
lat = c(coords.RS[, which.closest.RS[2]], coords.IS[, 2]),
data = c(summary.model3$pred.mat[102, ], ISdata[102, ]))
which.closest.RS[1]
pred.spatial.month102 <- cbind.data.frame(lon = c(coords.RS[which.closest.RS, 1], coords.IS[, 1]),
lat = c(coords.RS[which.closest.RS, 2], coords.IS[, 2]),
data = c(summary.model3$pred.mat[102, ], ISdata[102, ]))
sp::coordinates(pred.spatial.month102) <- c("lon", "lat")
sp::spplot(pred.spatial.month102, colorkey = TRUE, pch = 16,
cex=c(rep(0.5, 997), rep(1, 9)), col.regions = rev(viridis::viridis(100)),
sp.layout = list("sp.points", locations.insitu, pch = 1,
col = "white", cex = 1.25), scales = list(draw = TRUE),
xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(pred.spatial.month102, colorkey = TRUE, pch = 16,
cex=c(rep(0.5, 997), rep(1, 9)), col.regions = rev(viridis::viridis(100)),
sp.layout = list("sp.points", locations.insitu, pch = 1,
col = "white", cex = 1.25), scales = list(draw = TRUE),
xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)")
sp::spplot(pred.spatial.month102, colorkey = TRUE, pch = 16,
cex=c(rep(0.5, 997), rep(1, 9)), col.regions = rev(viridis::viridis(100)),
sp.layout = list("sp.points", locations.insitu, pch = 1,
col = "black", cex = 1.25), scales = list(draw = TRUE),
xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)")
sp::spplot(pred.spatial.month102, colorkey = TRUE, pch = 16,
cex=c(rep(0.75, 997), rep(1, 9)), col.regions = rev(viridis::viridis(100)),
sp.layout = list("sp.points", locations.insitu, pch = 1,
col = "black", cex = 1.25), scales = list(draw = TRUE),
xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)")
sp::spplot(pred.spatial.month102, colorkey = TRUE, pch = 16,
cex=c(rep(0.75, 997), rep(1, 9)), col.regions = rev(viridis::viridis(100)),
sp.layout = list("sp.points", locations.insitu, pch = 1,
col = "white", cex = 1.25), scales = list(draw = TRUE),
xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)")
sp::spplot(pred.spatial.month102, colorkey = TRUE, pch = 16,
cex=c(rep(1, 997), rep(1, 9)), col.regions = rev(viridis::viridis(100)),
sp.layout = list("sp.points", locations.insitu, pch = 1,
col = "white", cex = 1.25), scales = list(draw = TRUE),
xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)")
sp::spplot(pred.spatial.month102, colorkey = TRUE, pch = 16,
cex = 1, col.regions = rev(viridis::viridis(100)),
sp.layout = list("sp.points", locations.insitu, pch = 1,
col = "white", cex = 1.25), scales = list(draw = TRUE),
xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)")
min(data.spatial.month102@data)
min(pred.spatial.month102@data)
cuts <- seq(from = min(c(data.spatial.month102@data, pred.spatial.month102@data, ISdata)),
to = max(c(data.spatial.month102@data, pred.spatial.month102@data, ISdata)),
length.out = 100)
data.spatial.month102 <- cbind.data.frame(lon = c(coords.RS[, 1], coords.IS[, 1]),
lat = c(coords.RS[, 2], coords.IS[, 2]),
data = c(RSdata[102, ], ISdata[102, ]))
sp::coordinates(data.spatial.month102) <- c("lon", "lat")
locations.insitu <- cbind.data.frame(lon = coords.IS[, 1], lat = coords.IS[, 2])
sp::coordinates(locations.insitu) <- c("lon", "lat")
sp::spplot(data.spatial.month102, colorkey = TRUE, pch = 16,
cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(viridis::viridis(100)),
sp.layout = list("sp.points", locations.insitu, pch = 1,
col = "white", cex = 1.25), scales = list(draw = TRUE),
xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)")
cuts <- seq(from = min(c(data.spatial.month102@data, pred.spatial.month102@data, ISdata)),
to = max(c(data.spatial.month102@data, pred.spatial.month102@data, ISdata)),
length.out = 100)
sp.data <- sp::spplot(data.spatial.month102, colorkey = TRUE, pch = 16,
cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(viridis::viridis(100)),
sp.layout = list("sp.points", locations.insitu, pch = 1,
col = "white", cex = 1.25), scales = list(draw = TRUE),
xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)",
cuts = cuts, main = "Data for month 102")
sp.pred <- sp::spplot(pred.spatial.month102, colorkey = TRUE, pch = 16,
cex = 1, col.regions = rev(viridis::viridis(100)),
sp.layout = list("sp.points", locations.insitu, pch = 1,
col = "white", cex = 1.25), scales = list(draw = TRUE),
xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)",
cuts = cuts, main = "Predictions for month 102")
plot(sp.data, position = c(0.5, 0, 1, 1), more = TRUE)
c(data.spatial.month102@data, pred.spatial.month102@data, ISdata)
c(data.spatial.month102@data, pred.spatial.month102@data, ISdata)
cuts <- seq(from = min(c(unlist(data.spatial.month102@data), unlist(pred.spatial.month102@data), ISdata)),
to = max(c(unlist(data.spatial.month102@data), unlist(pred.spatial.month102@data), ISdata)),
length.out = 100)
cuts <- seq(from = min(c(unlist(data.spatial.month102@data), unlist(pred.spatial.month102@data), ISdata),
na.rm = TRUE),
to = max(c(unlist(data.spatial.month102@data), unlist(pred.spatial.month102@data), ISdata),
na.rm = TRUE),
length.out = 100)
sp.data <- sp::spplot(data.spatial.month102, colorkey = TRUE, pch = 16,
cex=c(rep(0.5, 7616), rep(1, 9)), col.regions = rev(viridis::viridis(100)),
sp.layout = list("sp.points", locations.insitu, pch = 1,
col = "white", cex = 1.25), scales = list(draw = TRUE),
xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)",
cuts = cuts, main = "Data for month 102")
sp.pred <- sp::spplot(pred.spatial.month102, colorkey = TRUE, pch = 16,
cex = 1, col.regions = rev(viridis::viridis(100)),
sp.layout = list("sp.points", locations.insitu, pch = 1,
col = "white", cex = 1.25), scales = list(draw = TRUE),
xlab = "Longitude (degrees East)", ylab = "Latitude (degrees North)",
cuts = cuts, main = "Predictions for month 102")
plot(sp.data, position = c(0.5, 0, 1, 1), more = TRUE)
plot(sp.pred, position = c(0, 0, 1, 0.5), more = FALSE)
pred2.spatial.month102 <- cbind.data.frame(lon = c(coords.RS[which.closest.RS, 1]),
lat = c(coords.RS[which.closest.RS, 2]),
data = c(summary.model3$pred.mat[102, ]))
sp::coordinates(pred2.spatial.month102) <- c("lon", "lat")
lwrbnd.spatial.month102 <- cbind.data.frame(lon = c(coords.RS[which.closest.RS, 1]),
lat = c(coords.RS[which.closest.RS, 2]),
data = c(summary.model3$lwrbnd.mat[102, ]))
sp::coordinates(lwrbnd.spatial.month102) <- c("lon", "lat")
uprbnd.spatial.month102 <- cbind.data.frame(lon = c(coords.RS[which.closest.RS, 1]),
lat = c(coords.RS[which.closest.RS, 2]),
data = c(summary.model3$uprbnd.mat[102, ]))
sp::coordinates(uprbnd.spatial.month102) <- c("lon", "lat")
cuts2 <- seq(from = min(c(unlist(pred2.spatial.month102@data),
unlist(lwrbnd.spatial.month102@data),
unlist(uprbnd.spatial.month102@data)), na.rm = TRUE),
to = max(c(unlist(pred2.spatial.month102@data),
unlist(lwrbnd.spatial.month102@data),
unlist(uprbnd.spatial.month102@data)), na.rm = TRUE),
length.out = 100)
sp.pred2 <- sp::spplot(pred2.spatial.month102, colorkey = TRUE, pch = 16,
cex = 1, col.regions = rev(viridis::viridis(100)),
scales = list(draw = TRUE), xlab = "Longitude (degrees East)",
ylab = "Latitude (degrees North)", cuts = cuts2,
main = "Predictions for month 102")
sp.lwrbnd <- sp::spplot(lwrbnd.spatial.month102, colorkey = TRUE, pch = 16,
cex = 1, col.regions = rev(viridis::viridis(100)),
scales = list(draw = TRUE), xlab = "Longitude (degrees East)",
ylab = "Latitude (degrees North)", cuts = cuts2,
main = "95% credible interval lower bound for month 102")
sp.uprbnd <- sp::spplot(uprbnd.spatial.month102, colorkey = TRUE, pch = 16,
cex = 1, col.regions = rev(viridis::viridis(100)),
scales = list(draw = TRUE), xlab = "Longitude (degrees East)",
ylab = "Latitude (degrees North)", cuts = cuts2,
main = "95% credible interval upper bound for month 102")
plot(sp.data2, position = c(0, 0.66, 1, 0.99), more = TRUE)
plot(sp.lwrbnd, position = c(0, 0.33, 1, 0.66), more = TRUE)
plot(sp.uprbnd, position = c(0, 0, 1, 0.33), more = FALSE)
plot(sp.pred2, position = c(0, 0.66, 1, 0.99), more = TRUE)
plot(sp.lwrbnd, position = c(0, 0.33, 1, 0.66), more = TRUE)
plot(sp.uprbnd, position = c(0, 0, 1, 0.33), more = FALSE)
plot(sp.data, position = c(0, 0.5, 1, 1), more = TRUE)
plot(sp.pred, position = c(0, 0, 1, 0.5), more = FALSE)
library(coda)
library(codsp)
library(sp)
library(viridis)
library(Rcpp)
library(RcppArmadillo)
library(lubridate)
library(fda)
library(RTriangle)
citation("coda")
citation("fda")
citation("lubridate")
citation("Rcpp")
citation("RcppArmadillo")
citation("RTriangle")
citation(sp)
citation("sp")
par(mar=c(4,4.5,1,0.5))
plot(coords.RS, pch = 15, cex = 0.25, col = "grey", xlab = "Longitude (degrees East)",
ylab = "Latitude (degrees North)", bty = "n")
points(coords.IS, pch = 16, col = "dodgerblue")
points(coords.RS[which.closest, ], pch = 4, col = "red")
legend("topleft", legend = c("Satellite grid cell centres", "In situ point locations",
"Closest grid cells to point locations"), pch = c(15, 16, 4),
pt.cex = c(0.25, 1, 1), col = c("grey", "dodgerblue", "red"), bty = "n")
par(mar=c(4,4.5,1,0.5))
plot(ISdata[, 6] ~ months.balaton, type = "o", pch = 16, col = "black", xlab = "Year",
ylab = "Data value", ylim = c(min(c(ISdata[, 6], RSdata[, which.closest[6]]),
na.rm = TRUE),
max(c(ISdata[, 6], RSdata[, which.closest[6]]),
na.rm = TRUE)), bty = "n")
points(RSdata[, which.closest[6]] ~ months.balaton, type = "o", pch = 15,
col= "deepskyblue", lty = 2)
legend("topright", legend = c("In situ data", "Satellite data"), pch = c(16, 15),
lty = c(1, 2), col = c("black", "deepskyblue"), horiz = TRUE, bty = "n")
par(mar=c(4,4.5,1,0.5))
plot(ISdata[, 6] ~ months.balaton, type = "o", pch = 16, col = "grey", xlab = "Year",
ylab = "Data value", ylim = c(min(c(ISdata[, 6], RSdata[, which.closest[6]]),
na.rm = TRUE),
max(c(ISdata[, 6], RSdata[, which.closest[6]]),
na.rm = TRUE)), bty = "n")
lines(RSdata[, which.closest[6]] ~ months.balaton, pch = 15, col= "deepskyblue", lty = 2)
legend("topright", legend = c("In situ data", "Satellite data"), pch = c(16, 15),
lty = c(1, 2), col = c("black", "deepskyblue"), horiz = TRUE, bty = "n")
par(mar=c(4,4.5,1,0.5))
plot(ISdata[, 6] ~ months.balaton, type = "o", pch = 16, col = "grey", xlab = "Year",
ylab = "Data value", ylim = c(min(c(ISdata[, 6], RSdata[, which.closest[6]]),
na.rm = TRUE),
max(c(ISdata[, 6], RSdata[, which.closest[6]]),
na.rm = TRUE)), bty = "n")
lines(RSdata[, which.closest[6]] ~ months.balaton, pch = 15, col= "deepskyblue", lty = 2)
legend("topright", legend = c("In situ data", "Satellite data"), pch = c(16, NA),
lty = c(1, 2), col = c("grey", "deepskyblue"), horiz = TRUE, bty = "n")
library(viridis)
package_version(viridis())
package_version("viridis")
library(NSD)
install.packages("qpdf")
library(NSD)
library(NSD)
browseVignettes('NSD')
?devtools::build_vignettes
devtools::build_vignettes()
library(NSD)
browseVignettes("NSD")
?browseVignettes
?vignette()
vignette()
library(NSD)
vignette()
install.packages("C:\\Users\\craig\\OneDrive - University of Glasgow\\Papers_drafts_submitted\\nonparametric_statistical_downscaling\\R_package_test\\NSD_with_3_sources_v2\\NSD_0.0.0.9001.tar.gz")
install.packages("C:\\Users\\craig\\OneDrive - University of Glasgow\\Papers_drafts_submitted\\nonparametric_statistical_downscaling\\R_package_test\\NSD_with_3_sources_v2\\NSD_0.0.0.9001.tar.gz",repos=NULL)
library(NSD)
browseVignettes("NSD")
browseVignettes("NSD")
?colbind
library(NSD)
