data(ISdata)
data(RSdata)
data(coords.IS)
data(coords.RS)
data(coords.outline)
data(which.closest)
data(which.closest.RS)
data(months.balaton)

# Let's predict at a sequence of 250 times at prediction location P1 (see
# Wilkie et al. 2018):
et.pred <- seq(min(months.balaton), max(months.balaton), length.out = 250)
p.RS.1 <- 425
pred.P1 <- run.NSDmodelMulti(nIter=1000, nBurnIn=10, nChains=2, nThin=2,yData=ISdata, xData=RSdata[, which.closest], zData = RSdata[, which.closest],
                             xPred=RSdata[, p.RS.1], zPred = RSdata[, p.RS.1], coordsData=coords.IS, coordsPred=coords.RS[p.RS.1, ], 
                             times.yData = months.balaton, times.xData = months.balaton, times.xPred = months.balaton, times.yPred = et.pred,
                             times.zData = months.balaton, times.zPred = months.balaton,
                             basis.type = "fourier",basis.dim = 9,period = 1)
# Warnings appear about providing times in Date format. This is OK, but note that we set period = 1 instead of period = 365, since the
# function converts the dates to decimal years, e.g. "2002-06-15" is converted to approximately 2002.452, so that one unit of time is one
# year instead of one day.

summary.P1 <- summary_NSD(pred.P1)

# Get the predictions and 95\% credible interval bounds from the summary:

# Plot the estimates for P1 and the 95\% credible intervals:
plot(summary.P1$pred.mat[,1] ~ et.pred, type = "l", ylim = c(min(summary.P1$lwrbnd.mat[,1]), 
                                                             max(summary.P1$uprbnd.mat[,1])), xlab = "Year", ylab = "Log(chlorophyll-a)")
lines(summary.P1$lwrbnd.mat[,1] ~ et.pred, lty = 2)
lines(summary.P1$uprbnd.mat[,1] ~ et.pred, lty = 2)

